<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>明治紺白大合戦投票フォーム</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/thanks.css">
    <script>
        (function (d) {
            var config = {
                    kitId: 'tnz3wzb',
                    scriptTimeout: 3000,
                    async: true
                },
                h = d.documentElement,
                t = setTimeout(function () {
                    h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
                }, config.scriptTimeout),
                tk = d.createElement("script"),
                f = false,
                s = d.getElementsByTagName("script")[0],
                a;
            h.className += " wf-loading";
            tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
            tk.async = true;
            tk.onload = tk.onreadystatechange = function () {
                a = this.readyState;
                if (f || a && a != "complete" && a != "loaded") return;
                f = true;
                clearTimeout(t);
                try {
                    Typekit.load(config)
                } catch (e) {}
            };
            s.parentNode.insertBefore(tk, s)
        })(document);
    </script>
    <script>
        (function (d) {
            var config = {
                    kitId: 'tnz3wzb',
                    scriptTimeout: 3000,
                    async: true
                },
                h = d.documentElement,
                t = setTimeout(function () {
                    h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
                }, config.scriptTimeout),
                tk = d.createElement("script"),
                f = false,
                s = d.getElementsByTagName("script")[0],
                a;
            h.className += " wf-loading";
            tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
            tk.async = true;
            tk.onload = tk.onreadystatechange = function () {
                a = this.readyState;
                if (f || a && a != "complete" && a != "loaded") return;
                f = true;
                clearTimeout(t);
                try {
                    Typekit.load(config)
                } catch (e) {}
            };
            s.parentNode.insertBefore(tk, s)
        })(document);
    </script>
    <script>
        (function (d) {
            var config = {
                    kitId: 'tnz3wzb',
                    scriptTimeout: 3000,
                    async: true
                },
                h = d.documentElement,
                t = setTimeout(function () {
                    h.className = h.className.replace(/\bwf-loading\b/g, "") + " wf-inactive";
                }, config.scriptTimeout),
                tk = d.createElement("script"),
                f = false,
                s = d.getElementsByTagName("script")[0],
                a;
            h.className += " wf-loading";
            tk.src = 'https://use.typekit.net/' + config.kitId + '.js';
            tk.async = true;
            tk.onload = tk.onreadystatechange = function () {
                a = this.readyState;
                if (f || a && a != "complete" && a != "loaded") return;
                f = true;
                clearTimeout(t);
                try {
                    Typekit.load(config)
                } catch (e) {}
            };
            s.parentNode.insertBefore(tk, s)
        })(document);
    </script>
</head>

<body>
    <main class="padding">
        <div class="center">
            <img class="thanks_logo" src="assets/img/konhaku_logo.png" alt="">
        </div>
        <p class="center thanks_text">投票が完了しました。<br>
            結果発表までしばらくお待ちください。</p>
        <p class="main_text">こちらの投票完了画面が<span class="pink">「明大祭大抽選会」</span>にご参加いただける抽選券の引換画面となります。<br>
            参加をご希望される方は、総務局の企画受付場所である<span class="line_marker">第一校舎学部掲示板前</span>へお越しください。<br>
            詳しくは公式パンフレットp.13をご参照ください。
            抽選券の枚数には限りがございます。あらかじめご了承ください。</p>
        <div class="map_content center">
            <img class="map" src="assets/img/mc_map_board.jpg" alt="">
        </div>
        <p class="thanks_text thanks_indent">※会場にいる実行委員が押すボタンですので、<span class="red">押さずに</span>会場までお越しください。</p>

        <form>
            <div class="slide-submit">
                <button type="submit" id="slideSubmit">→</button>
                <label>チケットを使用する</label>
            </div>
        </form>
    </main>

    <script>
$(".slide-submit button").draggable({
cancel: false,
containment: "parent",
axis: "x",
stop: function () {
if (($(this).parent().width() / 2) === ($(this).position().left + 8)) {
$(this).css({
left: "auto",
right: 0
}).addClass("submitted").text("使用済み").draggable('false');
$(this).closest("form").submit();
} else {
$(this).css({
left: 0
});
}
}
}).on("click", function () {
return false;
});


document.addEventListener("touchstart", touchHandler, true);
document.addEventListener("touchmove", touchHandler, true);
document.addEventListener("touchend", touchHandler, true);
document.addEventListener("touchcancel", touchHandler, true);

function touchHandler(event) {
var touch = event.changedTouches[0];

var simulatedEvent = document.createEvent("MouseEvent");
simulatedEvent.initMouseEvent({
touchstart: "mousedown",
touchmove: "mousemove",
touchend: "mouseup"
} [event.type], true, true, window, 1,
touch.screenX, touch.screenY,
touch.clientX, touch.clientY, false,
false, false, false, 0, null);

touch.target.dispatchEvent(simulatedEvent);
event.preventDefault();
}
    </script>
<script>
$(document).ready(function () {
var hasSlided = localStorage.getItem('hasSlided'); // localStorageからフラグを読み込む
if (hasSlided) {
// フラグがセットされている場合、スライドがすでに実行されていることを意味します
// したがって、再度実行しないようにします
$(".slide-submit button").addClass("submitted").text("使用済み").draggable('disable');
} else {
// スライドが実行されていない場合、スライド可能にします
$(".slide-submit button").draggable({
cancel: false,
containment: "parent",
axis: "x",
stop: function () {
if (($(this).parent().width() / 2) === ($(this).position().left + 8)) {
$(this).css({
left: "auto",
right: 0
}).addClass("submitted").text("使用済み").draggable('disable');
$(this).closest("form").submit();

// フラグをlocalStorageにセットして、スライドが実行されたことを記録します
localStorage.setItem('hasSlided', 'true');
} else {
$(this).css({
left: 0
});
}
}
}).on("click", function () {
return false;
});
}
});

document.addEventListener("touchstart", touchHandler, true);
document.addEventListener("touchmove", touchHandler, true);
document.addEventListener("touchend", touchHandler, true);
document.addEventListener("touchcancel", touchHandler, true);

function touchHandler(event) {
var touch = event.changedTouches[0];

var simulatedEvent = document.createEvent("MouseEvent");
simulatedEvent.initMouseEvent({
touchstart: "mousedown",
touchmove: "mousemove",
touchend: "mouseup"
} [event.type], true, true, window, 1,
touch.screenX, touch.screenY,
touch.clientX, touch.clientY, false,
false, false, false, 0, null);

touch.target.dispatchEvent(simulatedEvent);
event.preventDefault();
}
</script>
</body>

</html>
